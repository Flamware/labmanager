<!DOCTYPE html >
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="fragments/head :: style"/>
    <th:block th:replace="fragments/head :: script"/>

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

</head>

<body>

<div class="horizontal-main-wrapper">
    <!-- main content area start -->
    <div class="main-content">
        <div class="main-content-inner">
            <div class="row" th:if="${param.error != null}">
                <div class="col-lg-12">
                    <div class="card bg-danger">
                        <div class="card-body">
                            <h4 class="header-title">Error :</h4>
                            <p th:text="${param.message != null ?  param.message : ''}"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" th:if="${param.success != null}">
                <div class="col-lg-12">
                    <div class="card bg-success">
                        <div class="card-body">
                            <p th:text="${param.success != null ?  param.success : ''}"></p>
                            <h4 class="header-title">Publications merged from old author to the new one</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" th:if="${param.updated != null}">
                <div class="col-lg-12">
                    <div class="card bg-success">
                        <div class="card-body">
                            <h4 class="header-title">Author updated</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="main-content-inner">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="header-title">Add new journal</h4>
                            <form id="form" th:action="@{'/addJournal'}" method="post" >
                                <div class="form-group">
                                    <label for="journalName" class="col-form-label">Journal name</label>
                                    <input class="form-control" type="text" placeholder="" id="journalName" name="journalName">
                                </div>

                                <div class="form-group">
                                    <label for="journalPublisher" class="col-form-label">Journal publisher</label>
                                    <input class="form-control" type="text" placeholder="" id="journalPublisher" name="journalPublisher">
                                </div>

                                <div class="form-group">
                                    <label for="journalElvesier" class="col-form-label">Journal Elvesier</label>
                                    <input class="form-control" type="text" placeholder="" id="journalElvesier" name="journalElvesier">
                                </div>

                                <div class="form-group">
                                    <label for="journalScimago" class="col-form-label">Journal Scimago</label>
                                    <input class="form-control" type="text" placeholder="" id="journalScimago" name="journalScimago">
                                </div>

                                <div class="form-group">
                                    <label for="journalWos" class="col-form-label">Journal Wos</label>
                                    <input class="form-control" type="text" placeholder="" id="journalWos" name="journalWos">
                                </div>


                                <button type="submit" class="btn btn-success mt-4 pr-4 pl-4">Create journal</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="header-title">Author editing tool</h4>
                            <form id="form2" th:action="@{'/renameAuthor'}" method="post" >
                                <div class="form-group" id="containerAuthor">
                                    <label for="publicationAuthorsDiv" class="col-form-label">Author to edit</label>
                                    <div id="publicationAuthorsDiv">
                                        <select id="author" name="author"  class="form-control selectAuthor list-group-item list-group-item-action" style="width: 100%">
                                            <option></option>
                                            <option th:each="author : ${authors}" th:utext="${author.getAutFirstName() + ' ' + author.getAutLastName() }"></option>
                                        </select>
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label for="newFirstname" class="col-form-label">firstname (must be in ONE word, use - to join words)</label>
                                    <input class="form-control" type="text" placeholder="Jean-michel" id="newFirstname" name="newFirstname">
                                </div>

                                <div class="form-group">
                                    <label for="newLastname" class="col-form-label">Lastname (can be in multiple words)</label>
                                    <input class="form-control" type="text" placeholder="Dupont Pierre" id="newLastname" name="newLastname">
                                </div>

                                <div class="form-group">
                                    <label for="autMail" class="col-form-label">Email</label>
                                    <input class="form-control" type="text" placeholder="test@test.fr" id="autMail" name="autMail">
                                </div>

                                <button type="submit" class="btn btn-success mt-4 pr-4 pl-4">Rename</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- main content area end -->
</div>
<!-- page container area end -->
</body>

<script th:inline="javascript">

    $(document).ready(function () {
        $('.selectAuthor').select2();
    });

    $('#author').on('select2:select', function (e) {
        var data = e.params.data.text;
        if(data != "") {
            var href = /*[[@{/getAuthorData}]]*/ '/getAuthorData';
            $.ajax(href + '?name=' + data, {
                success: function(newData) {
                    $('#newFirstname').val(newData.autFirstName);
                    $('#newLastname').val(newData.autLastName);
                    $('#autMail').val(newData.autMail);
                },
                error: function() {
                    alert("ERROR");
                }
            });
        }

    });
</script>
</html>

